<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>TechCrush Gaming | Play & Earn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/8074/8074800.png" type="image/png">
    
    <script type="module" src="auth.js?v=5"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { heading: ['Rajdhani', 'sans-serif'], body: ['Inter', 'sans-serif'] },
                    animation: { 'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite' }
                }
            }
        }
    </script>
    <style>
        /* MAIN STYLES */
        body { background-color: #050b14; color: white; background-image: radial-gradient(circle at 50% 0%, #1e1b4b 0%, transparent 50%); overflow-x: hidden; }
        .glass { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(12px); }
        .neon-text { text-shadow: 0 0 10px rgba(99, 102, 241, 0.5); }
        .card-hover:hover { transform: translateY(-5px); border-color: rgba(99, 102, 241, 0.5); }
        .popular-card { border: 1px solid rgba(234, 179, 8, 0.5); box-shadow: 0 0 20px rgba(234, 179, 8, 0.1); }
        .seat-full-btn { background-color: #334155 !important; color: #94a3b8 !important; cursor: not-allowed !important; pointer-events: none; }
        .float-wa { position: fixed; width: 60px; height: 60px; bottom: 20px; right: 20px; background-color: #25d366; color: #FFF; border-radius: 50px; text-align: center; font-size: 30px; box-shadow: 2px 2px 3px #999; z-index: 100; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
        .float-wa:hover { transform: scale(1.1); box-shadow: 0 0 15px #25d366; }
        
        #notification-container { position: fixed; bottom: 20px; left: 20px; z-index: 99; display: flex; flex-direction: column; gap: 10px; pointer-events: none; }
        .live-toast { background: rgba(15, 23, 42, 0.95); border-left: 4px solid #4ade80; color: white; padding: 12px 20px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); font-family: 'Inter', sans-serif; font-size: 13px; min-width: 250px; transform: translateX(-150%); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; align-items: center; gap: 10px; }
        .live-toast.show { transform: translateX(0); }
        
        #maintenance-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #020617; z-index: 99999; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        
        /* üèÜ PREMIUM GOLD ANNOUNCEMENT BAR */
        #top-notice-bar { 
            display: none; 
            background: linear-gradient(90deg, #facc15 0%, #eab308 100%); 
            color: #020617; 
            text-align: center; 
            padding: 10px; 
            font-weight: 800; 
            font-size: 14px; 
            width: 100%; 
            animation: fadeIn 1s;
            text-transform: uppercase; 
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(234, 179, 8, 0.3);
            border-bottom: 1px solid #ca8a04;
        }

        /* üë§ PROFILE DROPDOWN STYLES */
        .profile-btn {
            width: 40px; height: 40px;
            background: linear-gradient(135deg, #6366f1, #818cf8);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.2);
            transition: transform 0.2s;
        }
        .profile-btn:hover { transform: scale(1.1); border-color: #fbbf24; }

        .profile-menu {
            display: none;
            position: absolute;
            top: 50px; right: 0;
            width: 220px;
            background: #1e293b;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 50;
            animation: slideDown 0.2s ease-out;
        }
        .profile-menu.active { display: block; }

        .menu-item {
            display: flex; align-items: center; gap: 10px;
            padding: 10px;
            color: #cbd5e1;
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .menu-item:hover { background: rgba(255,255,255,0.05); color: #fbbf24; }
        .menu-divider { height: 1px; background: rgba(255,255,255,0.1); margin: 5px 0; }

        .site-footer { background-color: rgba(5, 11, 20, 0.95); border-top: 1px solid rgba(255, 255, 255, 0.1); color: #94a3b8; padding: 50px 0 20px; font-family: 'Inter', sans-serif; font-size: 14px; line-height: 1.6; margin-top: 60px; }
        .footer-container { display: flex; flex-wrap: wrap; justify-content: space-between; max-width: 1000px; margin: 0 auto; padding: 0 20px; }
        .footer-col { flex: 1; min-width: 220px; margin-bottom: 25px; }
        .footer-heading { color: #6366f1; font-family: 'Rajdhani', sans-serif; font-weight: 700; text-transform: uppercase; margin-bottom: 15px; font-size: 18px; letter-spacing: 1px; }
        .footer-links a { color: #cbd5e1; text-decoration: none; display: block; margin-bottom: 8px; cursor: pointer; transition: color 0.3s; }
        .footer-links a:hover { color: #6366f1; padding-left: 5px; }
        .footer-bottom { border-top: 1px solid rgba(255, 255, 255, 0.05); text-align: center; padding-top: 20px; margin-top: 20px; font-size: 12px; color: #64748b; }
        .warning-text { color: #ef4444; font-weight: bold; font-size: 12px; margin-top: 10px; display: block; }
        
        /* LOGIN STYLES */
        .auth-input { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; color: white; margin-bottom: 10px; }
        .auth-input:focus { outline: none; border-color: #6366f1; }

        .modal-overlay { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); }
        .modal-content { background-color: #0f172a; color: #e2e8f0; margin: 5% auto; padding: 0; border: 1px solid #6366f1; width: 90%; max-width: 600px; border-radius: 12px; box-shadow: 0 0 25px rgba(99, 102, 241, 0.2); animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from {transform: translateY(-50px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
        .modal-header { padding: 15px 20px; border-bottom: 1px solid #1e293b; background-color: #1e1b4b; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; }
        .modal-header h2 { margin: 0; color: #818cf8; font-family: 'Rajdhani', sans-serif; font-size: 20px; font-weight: 700; text-transform: uppercase; }
        .close-btn { color: #94a3b8; font-size: 28px; font-weight: bold; cursor: pointer; line-height: 20px; }
        .modal-body { padding: 20px; max-height: 60vh; overflow-y: auto; font-size: 14px; line-height: 1.6; }
        .modal-body h3 { color: #fbbf24; border-bottom: 1px solid #334155; padding-bottom: 5px; margin-top: 20px; }
        .modal-body ul { padding-left: 20px; margin-bottom: 10px; color: #cbd5e1;}
        .modal-footer { padding: 15px; text-align: right; border-top: 1px solid #1e293b; background-color: #0f172a; border-radius: 0 0 12px 12px; }
        .accept-btn { background-color: #2563eb; color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; text-transform: uppercase; font-size: 12px; transition: background 0.3s; }
        .accept-btn:hover { background-color: #1d4ed8; }
    </style>
</head>
<body class="min-h-screen font-body flex flex-col items-center justify-start pt-0 pb-4">

    <div id="maintenance-screen">
        <h1 class="text-4xl font-bold text-red-500 mb-2">üöß UNDER MAINTENANCE</h1>
        <p class="text-gray-400">We are upgrading our servers.<br>Please come back in 30 minutes.</p>
    </div>

    <div id="top-notice-bar"></div>

    <div id="auth-main-wrapper" class="w-full max-w-6xl px-4 mt-6 flex flex-col items-center relative">
        
        <div id="auth-container" class="glass rounded-xl p-6 border border-indigo-500/30 w-full max-w-md shadow-[0_0_15px_rgba(99,102,241,0.2)]">
            
            <div id="login-section">
                <h3 class="text-xl font-heading font-bold text-center mb-4 text-indigo-300">PLAYER LOGIN</h3>
                <input type="email" id="login-email" placeholder="Email Address" class="auth-input">
                <input type="password" id="login-password" placeholder="Password" class="auth-input">
                <button id="btn-login" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded-lg transition-colors mb-3">LOGIN</button>
                <p class="text-center text-xs text-gray-400">Don't have an account? <a href="#" id="link-to-signup" class="text-yellow-400 hover:underline">Register Now</a></p>
            </div>

            <div id="signup-section" style="display:none;">
                <h3 class="text-xl font-heading font-bold text-center mb-4 text-yellow-400">CREATE ACCOUNT</h3>
                <input type="text" id="signup-username" placeholder="Player Name (e.g. King_07)" class="auth-input">
                <input type="email" id="signup-email" placeholder="Email Address" class="auth-input">
                <input type="password" id="signup-password" placeholder="Create Password" class="auth-input">
                <button id="btn-signup" class="w-full bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2 rounded-lg transition-colors mb-3">REGISTER</button>
                <p class="text-center text-xs text-gray-400">Already have an account? <a href="#" id="link-to-login" class="text-indigo-400 hover:underline">Login Here</a></p>
            </div>
        </div>

        <div id="user-dashboard" style="display:none; width: 100%; position: relative;">
            <div class="flex justify-between items-center bg-slate-800/50 p-4 rounded-xl border border-white/10">
                <div>
                    <h2 class="text-xl font-bold text-white">Hi, <span id="display-username" class="text-yellow-400">Player</span>!</h2>
                    <p class="text-xs text-green-400">‚óè Online</p>
                </div>
                
                <div style="position: relative;">
                    <div class="profile-btn" onclick="toggleMenu()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                    </div>

                    <div id="profile-dropdown" class="profile-menu">
                        <div class="text-center p-2 mb-2 bg-black/20 rounded">
                            <p id="menu-email" class="text-xs text-gray-400">user@email.com</p>
                        </div>
                        <div class="menu-item" onclick="resetPassword()">
                            <span>üîê</span> Change Password
                        </div>
                        <div class="menu-divider"></div>
                        <div class="menu-item text-red-400" onclick="logoutUser()">
                            <span>üö™</span> Logout
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mb-8 px-4 mt-6">
        <h1 class="text-5xl font-bold font-heading mb-2 uppercase tracking-tight">TechCrush <span class="text-indigo-500 neon-text">Gaming</span></h1>
        <p class="text-gray-400">Official Tournament Platform</p>
        <div id="global-timer" class="text-2xl font-bold text-yellow-400 mt-2">Checking Time...</div>
        
        <div class="mt-6">
            <a href="claim.html" class="relative inline-flex items-center justify-center gap-2 px-8 py-3 font-heading font-bold text-black transition-all duration-300 bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 rounded-full hover:scale-105 hover:shadow-[0_0_20px_rgba(234,179,8,0.5)] focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-offset-2 focus:ring-offset-slate-900 animate-pulse-slow">
                <span class="text-xl">üèÜ</span>
                <span class="tracking-wider uppercase text-lg">Claim Winnings</span>
            </a>
        </div>
    </div>

    <div class="w-full max-w-6xl mb-10 px-4">
        <div class="grid md:grid-cols-3 gap-4 text-center">
            <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5">
                <div class="text-3xl mb-2">üéüÔ∏è</div>
                <h3 class="font-bold text-indigo-400">1. Join Contest</h3>
                <p class="text-xs text-gray-400">Select your Match Pot and pay entry fee.</p>
            </div>
            <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5">
                <div class="text-3xl mb-2">üì≤</div>
                <h3 class="font-bold text-indigo-400">2. Get Room ID</h3>
                <p class="text-xs text-gray-400">You will be added to the TechCrush WhatsApp Group.</p>
            </div>
            <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5">
                <div class="text-3xl mb-2">üèÜ</div>
                <h3 class="font-bold text-indigo-400">3. Play & Win</h3>
                <p class="text-xs text-gray-400">Win the match & get paid within 1 hour.</p>
            </div>
        </div>
    </div>

    <div class="grid md:grid-cols-3 gap-6 w-full max-w-6xl px-4">
        
        <div class="glass rounded-2xl p-6 relative overflow-hidden transition-all duration-300 card-hover border border-white/5 flex flex-col">
            <div id="badge-3" class="absolute top-0 right-0 bg-blue-600 text-xs font-bold px-3 py-1 rounded-bl-lg">Wait...</div>
            <h2 class="text-3xl font-heading font-bold mb-1 text-blue-300">Diamond Pot</h2>
            <div class="text-xs text-gray-500 font-bold mb-3 uppercase tracking-wider">Daily Slot: 10:00 PM</div>
            <p class="text-gray-400 text-sm mb-4">6 Players ‚Ä¢ <span id="sub-3" class="text-green-400 font-bold">Checking...</span></p>
            <div class="flex justify-between items-center bg-black/30 p-3 rounded-lg mb-4 mt-auto">
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Entry</div><div class="text-xl font-bold text-green-400">‚Çπ500</div></div>
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Winner</div><div class="text-xl font-bold text-yellow-400">‚Çπ1500</div></div>
            </div>
            <a id="btn-3" href="#" class="block w-full bg-indigo-600 hover:bg-indigo-500 text-white text-center font-bold py-3 rounded-xl transition-colors">LOADING...</a>
        </div>

        <div class="glass rounded-2xl p-6 relative overflow-hidden transition-all duration-300 card-hover popular-card flex flex-col transform md:-translate-y-2">
            <div class="absolute top-0 left-0 bg-yellow-500 text-black text-[10px] font-bold px-2 py-1 rounded-br-lg">POPULAR</div>
            <div id="badge-2" class="absolute top-0 right-0 bg-blue-600 text-xs font-bold px-3 py-1 rounded-bl-lg">Wait...</div>
            <h2 class="text-3xl font-heading font-bold mb-1 text-yellow-400">Gold Pot</h2>
            <div class="text-xs text-yellow-600 font-bold mb-3 uppercase tracking-wider">Daily Slots: 4:00 PM & 8:00 PM</div>
            <p class="text-gray-400 text-sm mb-4">6 Players ‚Ä¢ <span id="sub-2" class="text-green-400 font-bold">Checking...</span></p>
            <div class="flex justify-between items-center bg-black/30 p-3 rounded-lg mb-4 mt-auto border border-yellow-500/30">
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Entry</div><div class="text-xl font-bold text-green-400">‚Çπ200</div></div>
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Winner</div><div class="text-xl font-bold text-yellow-400">‚Çπ600</div></div>
            </div>
            <a id="btn-2" href="#" class="block w-full bg-yellow-600 hover:bg-yellow-500 text-white text-center font-bold py-3 rounded-xl transition-colors shadow-lg shadow-yellow-500/20">LOADING...</a>
        </div>

        <div class="glass rounded-2xl p-6 relative overflow-hidden transition-all duration-300 card-hover border border-white/5 flex flex-col">
            <div id="badge-1" class="absolute top-0 right-0 bg-blue-600 text-xs font-bold px-3 py-1 rounded-bl-lg">Wait...</div>
            <h2 class="text-3xl font-heading font-bold mb-1 text-gray-200">Silver Pot</h2>
            <div class="text-xs text-gray-500 font-bold mb-3 uppercase tracking-wider">Daily Slots: 2:00 PM & 6:00 PM</div>
            <p class="text-gray-400 text-sm mb-4">6 Players ‚Ä¢ <span id="sub-1" class="text-green-400 font-bold">Checking...</span></p>
            <div class="flex justify-between items-center bg-black/30 p-3 rounded-lg mb-4 mt-auto">
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Entry</div><div class="text-xl font-bold text-green-400">‚Çπ100</div></div>
                <div class="text-center"><div class="text-[10px] text-gray-500 uppercase">Winner</div><div class="text-xl font-bold text-yellow-400">‚Çπ300</div></div>
            </div>
            <a id="btn-1" href="#" class="block w-full bg-blue-600 hover:bg-blue-500 text-white text-center font-bold py-3 rounded-xl transition-colors">LOADING...</a>
        </div>

    </div>

    <a id="wa-link" href="#" target="_blank" class="float-wa">
        <svg width="35" height="35" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
    </a>

    <div id="notification-container"></div>

    <footer class="site-footer w-full">
        <div class="footer-container">
            <div class="footer-col">
                <div class="footer-heading">TechCrush India</div>
                <p>The #1 destination for competitive gaming. Join securely, play fairly, and win instantly.</p>
                <p class="warning-text">‚ö†Ô∏è 18+ Only | One User = One Account</p>
            </div>
            <div class="footer-col">
                <div class="footer-heading">Policies</div>
                <div class="footer-links">
                    <a onclick="openModal('terms')">Terms & Conditions</a>
                    <a onclick="openModal('refund')">Refund & Cancellation</a>
                    <a onclick="openModal('privacy')">Privacy Policy</a>
                    <a onclick="openModal('rules')">Fair Play Rules</a>
                </div>
            </div>
            <div class="footer-col">
                <div class="footer-heading">Support</div>
                <p><strong>WhatsApp:</strong> <span id="wa-display">...</span></p>
                <p><strong>Email:</strong> support@techcrush.in</p>
                <p><strong>Hours:</strong> 10:00 AM ‚Äì 8:00 PM (IST)</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 TechCrush.in. All Rights Reserved.</p>
        </div>
    </footer>

    <div id="infoModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Policy</h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer">
                <button class="accept-btn" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>

    <script type="module">
        // WAIT FOR AUTH TO BE READY
        // This script handles the Admin/Database Listener Logic
        // It relies on auth.js setting up the "window.techCrushRef" globals
        
        function waitForFirebase() {
            if(window.techCrushOnValue && window.techCrushRef && window.techCrushDB) {
                initializeSite();
            } else {
                setTimeout(waitForFirebase, 100);
            }
        }

        function initializeSite() {
            // Listen for Admin Changes
            window.techCrushOnValue(window.techCrushRef(window.techCrushDB, 'settings'), (snapshot) => {
                const data = snapshot.val();
                
                if (data) {
                    // 1. Maintenance
                    if (data.maintenance === "true") {
                        document.getElementById('maintenance-screen').style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                        return;
                    } else {
                        document.getElementById('maintenance-screen').style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }

                    // 2. Notice Bar
                    const noticeBar = document.getElementById('top-notice-bar');
                    if (data.notice && data.notice !== "") {
                        noticeBar.innerText = data.notice;
                        noticeBar.style.display = 'block';
                    } else {
                        noticeBar.style.display = 'none';
                    }

                    // 3. WhatsApp
                    document.getElementById('wa-link').href = "https://wa.me/" + data.whatsapp;
                    document.getElementById('wa-display').innerText = data.whatsapp;

                    // 4. Update Cards
                    updateAllCards(data);
                }
            });
        }

        function updateAllCards(data) {
            if (!data) return;

            const now = new Date();
            const currentHour = now.getHours(); 
            const allSlots = [14, 16, 18, 20, 22];
            let globalNext = null;
            for(let i=0; i<allSlots.length; i++) {
                if(allSlots[i] > currentHour) { globalNext = allSlots[i]; break; }
            }
            if(globalNext) {
                let p = globalNext >= 12 ? "PM" : "AM";
                let h = globalNext > 12 ? globalNext - 12 : globalNext;
                document.getElementById('global-timer').innerText = h + ":00 " + p;
            } else {
                document.getElementById('global-timer').innerText = "Tomorrow 2:00 PM";
            }

            function updateCard(bid, sid, btnid, slots, key, cardData) {
                const btn = document.getElementById(btnid);
                const b = document.getElementById(bid);
                const s = document.getElementById(sid);

                // Admin Status
                if (cardData.status === "FULL") {
                    b.innerText = "FULL"; b.className = "absolute top-0 right-0 text-xs font-bold px-3 py-1 rounded-bl-lg bg-red-600";
                    s.innerText = "Seats Filled";
                    btn.innerText = "SEATS FULL"; btn.className = "block w-full text-white text-center font-bold py-3 rounded-xl seat-full-btn";
                    btn.href = "#";
                    return; 
                }

                // Timing Logic
                let nextMatch = null;
                for (let i = 0; i < slots.length; i++) {
                    if (slots[i] > currentHour) { nextMatch = slots[i]; break; }
                }

                if (nextMatch) {
                    let period = nextMatch >= 12 ? "PM" : "AM";
                    let dh = nextMatch > 12 ? nextMatch - 12 : nextMatch;
                    b.innerText = "STARTS: " + dh + ":00 " + period;
                    s.innerText = "Match time: " + dh + ":00 " + period;
                    b.className = "absolute top-0 right-0 text-xs font-bold px-3 py-1 rounded-bl-lg bg-green-600";
                } else {
                    b.innerText = "CLOSED"; b.className = "absolute top-0 right-0 text-xs font-bold px-3 py-1 rounded-bl-lg bg-red-600";
                    s.innerText = "Next: Tomorrow";
                }
                
                btn.innerText = "JOIN ‚Çπ" + (key === 'silver' ? '100' : key === 'gold' ? '200' : '500');
                btn.className = "block w-full " + (key === 'silver' ? 'bg-blue-600 hover:bg-blue-500' : key === 'gold' ? 'bg-yellow-600 hover:bg-yellow-500' : 'bg-indigo-600 hover:bg-indigo-500') + " text-white text-center font-bold py-3 rounded-xl transition-colors";
                btn.href = cardData.link;
            }

            updateCard('badge-1', 'sub-1', 'btn-1', [14, 18], 'silver', data.silver);
            updateCard('badge-2', 'sub-2', 'btn-2', [16, 20], 'gold', data.gold);
            updateCard('badge-3', 'sub-3', 'btn-3', [22], 'diamond', data.diamond);
        }

        waitForFirebase();

        // ---------------------------------------------
        // LIVE NOTIFICATION LOGIC (POPUPS)
        // ---------------------------------------------
        const fakeNames = ["Rahul_K", "Amit99", "Priya_Cool", "Vicky_Don", "Sneha_M", "Rohan_Gamer", "Killer_007", "Ludo_King", "Anjali_S", "Vikram_Boss", "Arjun_P"];
        const fakeActions = [
            { text: "won ‚Çπ300 in Silver Pot", icon: "üî•" },
            { text: "joined Gold Pot", icon: "üöÄ" },
            { text: "withdrew ‚Çπ1500", icon: "üí∏" },
            { text: "won ‚Çπ600 in Gold Pot", icon: "üèÜ" }
        ];

        function showNotification() {
            const name = fakeNames[Math.floor(Math.random() * fakeNames.length)];
            const action = fakeActions[Math.floor(Math.random() * fakeActions.length)];
            const div = document.createElement("div");
            div.className = "live-toast";
            div.innerHTML = `<span class="toast-icon">${action.icon}</span> <span><strong>${name}</strong> ${action.text}</span>`;
            const container = document.getElementById("notification-container");
            container.appendChild(div);
            setTimeout(() => { div.classList.add("show"); }, 100);
            setTimeout(() => {
                div.classList.remove("show");
                setTimeout(() => { div.remove(); }, 500);
            }, 4000);
            const nextTime = Math.random() * 4000 + 4000;
            setTimeout(showNotification, nextTime);
        }
        setTimeout(showNotification, 2000);

        // MODAL LOGIC
        const policies = {
            terms: { title: "Terms & Conditions", body: `<h3>1. Eligibility</h3><p>Participation is limited to users 18+. One user = one account.</p><h3>2. Match Participation</h3><p>Join promptly using correct details. Admin decisions are final.</p>` },
            refund: { title: "Refund & Cancellation Policy", body: `<h3>1. Eligibility</h3><p>Refunds available for: Match Cancellation, Platform Errors, Late Joining (Contact Support).</p><h3>2. Non-Refundable</h3><p>No refund for Cheating/Bans or Third-Party Server issues.</p>` },
            privacy: { title: "Privacy Policy", body: `<h3>1. Data Usage</h3><p>We collect Name, WhatsApp, Game ID only for coordination. We DO NOT share data.</p>` },
            rules: { title: "Fair Play & Rules", body: `<h3>1. Zero Tolerance</h3><p>No cheating, hacking, or teaming. Violations = Instant Ban.</p>` }
        };

        function openModal(type) {
            const modal = document.getElementById('infoModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            if (policies[type]) {
                title.innerText = policies[type].title;
                body.innerHTML = policies[type].body;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden'; 
            }
        }
        function closeModal() {
            document.getElementById('infoModal').style.display = 'none';
            document.body.style.overflow = 'auto'; 
        }
        window.onclick = function(event) {
            var modal = document.getElementById('infoModal');
            if (event.target == modal) closeModal();
        }
    </script>
</body>
</html>
